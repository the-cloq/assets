document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("settings"),t=document.getElementById("submitBtn"),n=e.querySelectorAll("input"),d=document.querySelectorAll(".slider_wrap div");var o=document.getElementById("brightness"),i=document.getElementById("sensor_timer"),r=document.getElementById("summer_offset"),a=document.getElementById("winter_offset"),s=document.getElementById("cool"),l=document.getElementById("warm"),u=document.getElementById("hot"),c=o.value,m=i.value,y=r.value,p=a.value,g=s.value,f=l.value,E=u.value;let I=new Map;const v=[{id:"slider1",start:[c],range:{min:0,max:50},inputId:"brightness",padding:[1,0]},{id:"slider2",start:[m],range:{min:0,max:15},inputId:"sensor_timer",padding:[1,0]},{id:"slider3",start:[g,f,E],range:{min:0,max:40},inputIds:["cool","warm","hot"],connect:[!0,!0,!0,!0],padding:[0,0]},{id:"slider4",start:[y],range:{min:-12,max:12},inputId:"summer_offset",padding:[1,1]},{id:"slider5",start:[p],range:{min:-12,max:12},inputId:"winter_offset",padding:[1,1]}];function h(){let e=!1;n.forEach((t=>{"view-mode"!==t.name&&I.get(t)!==("checkbox"===t.type||"radio"===t.type?t.checked:t.value)&&(e=!0)})),d.forEach((t=>{JSON.stringify(t.noUiSlider.get())!==JSON.stringify(I.get(t))&&(e=!0)})),e?"none"===t.style.display||""===t.style.display?(t.style.display="block",t.disabled=!1,requestAnimationFrame((()=>{t.style.opacity="1",t.style.transform="scale(1.2)"}))):(t.style.opacity="1",t.style.transform="scale(1.2)"):(t.style.opacity="0",t.style.transform="scale(1)",setTimeout((()=>{t.style.display="none",t.disabled=!0}),300))}d.forEach(((e,t)=>{const n=v[t];noUiSlider.create(e,{start:n.start,range:n.range,tooltips:!0,connect:n.connect||[!0,!1],padding:n.padding||[0,0],format:{to:e=>Math.round(e),from:e=>Number(e)}}),I.set(e,e.noUiSlider.get()),Array.isArray(n.inputIds)?e.noUiSlider.on("update",(function(e){n.inputIds.forEach(((t,n)=>{document.getElementById(t).value=e[n]}))})):e.noUiSlider.on("update",(function(e){document.getElementById(n.inputId).value=e})),Array.isArray(n.inputIds)?n.inputIds.forEach(((t,d)=>{document.getElementById(t).addEventListener("input",(function(){let t=n.inputIds.map((e=>document.getElementById(e).value));e.noUiSlider.set(t),h()}))})):document.getElementById(n.inputId).addEventListener("input",(function(){e.noUiSlider.set(this.value),h()}))})),n.forEach((e=>{I.set(e,"checkbox"===e.type||"radio"===e.type?e.checked:e.value)})),n.forEach((e=>e.addEventListener("input",h))),d.forEach((e=>e.noUiSlider.on("update",h)))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("settings"),t=document.getElementById("submitBtn"),n=document.getElementById("overlay");e&&t&&n?e.addEventListener("submit",(function(d){d.preventDefault(),t.style.display="none",t.disabled=!0,n.classList.add("reveal");const o=new FormData(e);fetch(e.action,{method:"POST",body:o}).then((e=>{if(!e.ok)throw new Error(`Server responded with status ${e.status}`);return e.text()})).then((e=>{setTimeout((()=>{window.location.reload()}),300)})).catch((e=>{console.error("Form submission error:",e),n.classList.remove("reveal"),t.style.display="block",t.disabled=!1}))})):console.error("Required elements not found.")}));
